# tp_spec_decode Test Results

**Date:** 2026-02-21 09:02:08 UTC

## Configuration

| Parameter | Value |
|-----------|-------|
| Target Model | Kimi K2.5 (612GB MoE, 4-bit) |
| Draft Model | Moonlight 16B A3B Instruct (4-bit) |
| TP | 2 (hwstudio1 + hwstudio2) |
| Backend | JACCL (TB5 RDMA) |
| Speculative Method | draft_model |
| Num Speculative Tokens | 1 (k>=2 deadlocks -- Bug 7) |
| Continuous Batching | Enabled |
| KV Cache Quantization | FP8 |

## Single Request (Spec Decode)

| # | Status | Prompt Tokens | Completion Tokens | TTFT (ms) | Prefill tok/s | Decode tok/s | Total Time (s) |
|---|--------|---------------|-------------------|-----------|---------------|--------------|----------------|
| 1 | PASS | 40 | 256 | 1609.8 | 24.8 | 5.6 | 47.64 |

## 3 Sequential Requests

| # | Status | Prompt Tokens | Completion Tokens | TTFT (ms) | Prefill tok/s | Decode tok/s | Total Time (s) |
|---|--------|---------------|-------------------|-----------|---------------|--------------|----------------|
| 1 | PASS | 38 | 256 | 1397.3 | 27.2 | 5.2 | 50.32 |
| 2 | FAIL `TimeoutError: timed out` | 0 | 0 | 0.0 | 0.0 | 0.0 | 306.47 |
| 3 | FAIL `TimeoutError: timed out` | 0 | 0 | 0.0 | 0.0 | 0.0 | 300.08 |

## Summary

- **Working:** YES
- **Total requests:** 4
- **Successful:** 2
- **Failed:** 2
- **Avg TTFT:** 1503.6 ms
- **Avg prefill tok/s:** 26.0
- **Avg decode tok/s:** 5.4
- **Total output tokens:** 512
- **Avg per-request throughput:** 5.2 tok/s

## Errors

1. Test 3 (3 sequential): request failed - TimeoutError: timed out
2. Test 3 (3 sequential): request failed - TimeoutError: timed out

## Server Logs (excerpt)

### hwstudio1

*(showing last 200 of 2944 lines)*

```
2026-02-21 17:51:31,755 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=28995 post-trim: trim_amounts=[0], accepted_per_req={f831b4a1-b73a-4dd9-bf81-204170332685: 1}
2026-02-21 17:51:31,756 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=28995 PRE-BROADCAST trim=[0] new_y_len=1
2026-02-21 17:51:31,756 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=28995 POST-BROADCAST done
2026-02-21 17:51:31,808 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=28996, input_shape=(1, 2), n_reqs=1, cache_idx=40, draft_lengths=[1]
2026-02-21 17:51:31,808 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=28996 PRE-FORWARD input_shape=(1, 2) cache_idx=40
2026-02-21 17:51:31,885 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=28996 POST-FORWARD logits_shape=(1, 2, 163840)
2026-02-21 17:51:31,886 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=28996 POST-REJECT n_results=1
2026-02-21 17:51:31,886 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=28996 post-trim: trim_amounts=[0], accepted_per_req={f831b4a1-b73a-4dd9-bf81-204170332685: 1}
2026-02-21 17:51:31,887 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=28996 PRE-BROADCAST trim=[0] new_y_len=1
2026-02-21 17:51:31,887 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=28996 POST-BROADCAST done
2026-02-21 17:51:31,944 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=28997, input_shape=(1, 2), n_reqs=1, cache_idx=42, draft_lengths=[1]
2026-02-21 17:51:31,944 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=28997 PRE-FORWARD input_shape=(1, 2) cache_idx=42
2026-02-21 17:51:32,020 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=28997 POST-FORWARD logits_shape=(1, 2, 163840)
2026-02-21 17:51:32,021 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=28997 POST-REJECT n_results=1
2026-02-21 17:51:32,021 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=28997 post-trim: trim_amounts=[0], accepted_per_req={f831b4a1-b73a-4dd9-bf81-204170332685: 1}
2026-02-21 17:51:32,022 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=28997 PRE-BROADCAST trim=[0] new_y_len=1
2026-02-21 17:51:32,022 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=28997 POST-BROADCAST done
2026-02-21 17:51:32,023 [Rank 0] vllm_mlx.server INFO: [REQUEST] POST /v1/chat/completions stream=True model='default' max_tokens=256 temp=0.7 msgs=1 roles=['user'] total_chars=52 tools=0 response_format=None
2026-02-21 17:51:32,023 [Rank 0] vllm_mlx.server INFO: [REQUEST] last user message preview: 'Describe the process of photosynthesis step by step.'
2026-02-21 17:51:32,080 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=28998, input_shape=(1, 2), n_reqs=1, cache_idx=44, draft_lengths=[1]
2026-02-21 17:51:32,081 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=28998 PRE-FORWARD input_shape=(1, 2) cache_idx=44
2026-02-21 17:51:32,157 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=28998 POST-FORWARD logits_shape=(1, 2, 163840)
2026-02-21 17:51:32,158 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=28998 POST-REJECT n_results=1
2026-02-21 17:51:32,183 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=28998 post-trim: trim_amounts=[1], accepted_per_req={f831b4a1-b73a-4dd9-bf81-204170332685: 0}
2026-02-21 17:51:32,183 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=28998 PRE-BROADCAST trim=[1] new_y_len=1
2026-02-21 17:51:32,184 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=28998 POST-BROADCAST done
INFO:     100.95.28.121:55254 - "POST /v1/chat/completions HTTP/1.1" 200 OK
2026-02-21 17:51:32,184 [Rank 0] vllm_mlx.server INFO: [disconnect_guard] START poll_interval=0.5s
2026-02-21 17:51:32,242 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=28999, input_shape=(1, 2), n_reqs=1, cache_idx=45, draft_lengths=[1]
2026-02-21 17:51:32,242 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=28999 PRE-FORWARD input_shape=(1, 2) cache_idx=45
2026-02-21 17:51:32,318 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=28999 POST-FORWARD logits_shape=(1, 2, 163840)
2026-02-21 17:51:32,319 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=28999 POST-REJECT n_results=1
2026-02-21 17:51:32,319 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=28999 post-trim: trim_amounts=[0], accepted_per_req={f831b4a1-b73a-4dd9-bf81-204170332685: 1}
2026-02-21 17:51:32,319 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=28999 PRE-BROADCAST trim=[0] new_y_len=1
2026-02-21 17:51:32,320 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=28999 POST-BROADCAST done
2026-02-21 17:51:32,320 [Rank 0] vllm_mlx.server INFO: [disconnect_guard] first chunk arrived, elapsed=0.1s
2026-02-21 17:51:32,378 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29000, input_shape=(1, 2), n_reqs=1, cache_idx=47, draft_lengths=[1]
2026-02-21 17:51:32,378 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29000 PRE-FORWARD input_shape=(1, 2) cache_idx=47
2026-02-21 17:51:32,454 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29000 POST-FORWARD logits_shape=(1, 2, 163840)
2026-02-21 17:51:32,455 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29000 POST-REJECT n_results=1
2026-02-21 17:51:32,480 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29000 post-trim: trim_amounts=[1], accepted_per_req={f831b4a1-b73a-4dd9-bf81-204170332685: 0}
2026-02-21 17:51:32,480 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29000 PRE-BROADCAST trim=[1] new_y_len=1
2026-02-21 17:51:32,481 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29000 POST-BROADCAST done
2026-02-21 17:51:32,481 [Rank 0] vllm_mlx.scheduler DEBUG: Added request 05914e08-cecb-4263-bcb5-5be7209151ac with 36 prompt tokens
2026-02-21 17:51:32,481 [Rank 0] vllm_mlx.engine_core INFO: [stream_outputs] 05914e08-cec START waiting for tokens
2026-02-21 17:51:32,481 [Rank 0] vllm_mlx.scheduler INFO: [schedule] request=05914e08-cec uid=5 prompt_tokens=36 tokens_to_prefill=36 max_tokens=256 running=2 waiting=0
2026-02-21 17:51:32,739 [Rank 0] vllm_mlx.scheduler INFO: [prefill] request=05914e08-cec tokens=35/36
2026-02-21 17:51:32,791 [Rank 0] vllm_mlx.scheduler DEBUG: [_synced_step] rank=0 step=11 pre=1008 post=1008
2026-02-21 17:51:32,869 [Rank 0] vllm_mlx.scheduler DEBUG: [_synced_step] rank=0 step=12 pre=[387, 2742] post=[387, 2742]
2026-02-21 17:51:32,869 [Rank 0] vllm_mlx.engine_core INFO: [stream_outputs] 05914e08-cec first token after 0.4s
2026-02-21 17:51:32,975 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29002, input_shape=(2, 2), n_reqs=2, cache_idx=49, draft_lengths=[1, 1]
2026-02-21 17:51:32,976 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29002 PRE-FORWARD input_shape=(2, 2) cache_idx=49
2026-02-21 17:51:33,068 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29002 POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:33,069 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29002 POST-REJECT n_results=2
2026-02-21 17:51:33,096 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29002 post-trim: trim_amounts=[0, 1], accepted_per_req={f831b4a1-b73a-4dd9-bf81-204170332685: 1, 05914e08-cecb-4263-bcb5-5be7209151ac: 0}
2026-02-21 17:51:33,096 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29002 PRE-BROADCAST trim=[0, 1] new_y_len=2
2026-02-21 17:51:33,097 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29002 POST-BROADCAST done
2026-02-21 17:51:33,203 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29003, input_shape=(2, 2), n_reqs=2, cache_idx=51, draft_lengths=[1, 1]
2026-02-21 17:51:33,203 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29003 PRE-FORWARD input_shape=(2, 2) cache_idx=51
2026-02-21 17:51:33,297 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29003 POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:33,298 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29003 POST-REJECT n_results=2
2026-02-21 17:51:33,298 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29003 post-trim: trim_amounts=[0, 0], accepted_per_req={f831b4a1-b73a-4dd9-bf81-204170332685: 1, 05914e08-cecb-4263-bcb5-5be7209151ac: 1}
2026-02-21 17:51:33,298 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29003 PRE-BROADCAST trim=[0, 0] new_y_len=2
2026-02-21 17:51:33,299 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29003 POST-BROADCAST done
2026-02-21 17:51:33,407 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29004, input_shape=(2, 2), n_reqs=2, cache_idx=53, draft_lengths=[1, 1]
2026-02-21 17:51:33,407 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29004 PRE-FORWARD input_shape=(2, 2) cache_idx=53
2026-02-21 17:51:33,502 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29004 POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:33,503 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29004 POST-REJECT n_results=2
2026-02-21 17:51:33,529 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29004 post-trim: trim_amounts=[1, 0], accepted_per_req={f831b4a1-b73a-4dd9-bf81-204170332685: 0, 05914e08-cecb-4263-bcb5-5be7209151ac: 1}
2026-02-21 17:51:33,529 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29004 PRE-BROADCAST trim=[1, 0] new_y_len=2
2026-02-21 17:51:33,530 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29004 POST-BROADCAST done
2026-02-21 17:51:33,645 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29005, input_shape=(2, 2), n_reqs=2, cache_idx=54, draft_lengths=[1, 1]
2026-02-21 17:51:33,645 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29005 PRE-FORWARD input_shape=(2, 2) cache_idx=54
2026-02-21 17:51:33,740 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29005 POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:33,741 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29005 POST-REJECT n_results=2
2026-02-21 17:51:33,742 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29005 post-trim: trim_amounts=[0, 0], accepted_per_req={f831b4a1-b73a-4dd9-bf81-204170332685: 1, 05914e08-cecb-4263-bcb5-5be7209151ac: 1}
2026-02-21 17:51:33,742 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29005 PRE-BROADCAST trim=[0, 0] new_y_len=2
2026-02-21 17:51:33,742 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29005 POST-BROADCAST done
2026-02-21 17:51:33,859 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29006, input_shape=(2, 2), n_reqs=2, cache_idx=56, draft_lengths=[1, 1]
2026-02-21 17:51:33,859 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29006 PRE-FORWARD input_shape=(2, 2) cache_idx=56
2026-02-21 17:51:33,954 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29006 POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:33,955 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29006 POST-REJECT n_results=2
2026-02-21 17:51:33,978 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29006 post-trim: trim_amounts=[1, 1], accepted_per_req={f831b4a1-b73a-4dd9-bf81-204170332685: 0, 05914e08-cecb-4263-bcb5-5be7209151ac: 0}
2026-02-21 17:51:33,979 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29006 PRE-BROADCAST trim=[1, 1] new_y_len=2
2026-02-21 17:51:33,980 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29006 POST-BROADCAST done
2026-02-21 17:51:34,097 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29007, input_shape=(2, 2), n_reqs=2, cache_idx=57, draft_lengths=[1, 1]
2026-02-21 17:51:34,097 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29007 PRE-FORWARD input_shape=(2, 2) cache_idx=57
2026-02-21 17:51:34,193 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29007 POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:34,194 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29007 POST-REJECT n_results=2
2026-02-21 17:51:34,194 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29007 post-trim: trim_amounts=[0, 0], accepted_per_req={f831b4a1-b73a-4dd9-bf81-204170332685: 1, 05914e08-cecb-4263-bcb5-5be7209151ac: 1}
2026-02-21 17:51:34,195 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29007 PRE-BROADCAST trim=[0, 0] new_y_len=2
2026-02-21 17:51:34,195 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29007 POST-BROADCAST done
2026-02-21 17:51:34,314 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29008, input_shape=(2, 2), n_reqs=2, cache_idx=59, draft_lengths=[1, 1]
2026-02-21 17:51:34,314 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29008 PRE-FORWARD input_shape=(2, 2) cache_idx=59
2026-02-21 17:51:34,408 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29008 POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:34,409 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29008 POST-REJECT n_results=2
2026-02-21 17:51:34,435 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29008 post-trim: trim_amounts=[1, 1], accepted_per_req={f831b4a1-b73a-4dd9-bf81-204170332685: 0, 05914e08-cecb-4263-bcb5-5be7209151ac: 0}
2026-02-21 17:51:34,436 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29008 PRE-BROADCAST trim=[1, 1] new_y_len=2
2026-02-21 17:51:34,436 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29008 POST-BROADCAST done
2026-02-21 17:51:34,556 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29009, input_shape=(2, 2), n_reqs=2, cache_idx=60, draft_lengths=[1, 1]
2026-02-21 17:51:34,556 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29009 PRE-FORWARD input_shape=(2, 2) cache_idx=60
2026-02-21 17:51:34,649 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29009 POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:34,650 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29009 POST-REJECT n_results=2
2026-02-21 17:51:34,677 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29009 post-trim: trim_amounts=[1, 0], accepted_per_req={f831b4a1-b73a-4dd9-bf81-204170332685: 0, 05914e08-cecb-4263-bcb5-5be7209151ac: 1}
2026-02-21 17:51:34,677 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29009 PRE-BROADCAST trim=[1, 0] new_y_len=2
2026-02-21 17:51:34,678 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29009 POST-BROADCAST done
2026-02-21 17:51:34,797 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29010, input_shape=(2, 2), n_reqs=2, cache_idx=62, draft_lengths=[1, 1]
2026-02-21 17:51:34,797 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29010 PRE-FORWARD input_shape=(2, 2) cache_idx=62
2026-02-21 17:51:34,923 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29010 POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:34,924 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29010 POST-REJECT n_results=2
2026-02-21 17:51:34,951 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29010 post-trim: trim_amounts=[1, 1], accepted_per_req={f831b4a1-b73a-4dd9-bf81-204170332685: 0, 05914e08-cecb-4263-bcb5-5be7209151ac: 0}
2026-02-21 17:51:34,951 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29010 PRE-BROADCAST trim=[1, 1] new_y_len=2
2026-02-21 17:51:34,952 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29010 POST-BROADCAST done
2026-02-21 17:51:35,070 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29011, input_shape=(2, 2), n_reqs=2, cache_idx=63, draft_lengths=[1, 1]
2026-02-21 17:51:35,070 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29011 PRE-FORWARD input_shape=(2, 2) cache_idx=63
2026-02-21 17:51:35,169 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29011 POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:35,170 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29011 POST-REJECT n_results=2
2026-02-21 17:51:35,170 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29011 post-trim: trim_amounts=[0, 0], accepted_per_req={f831b4a1-b73a-4dd9-bf81-204170332685: 1, 05914e08-cecb-4263-bcb5-5be7209151ac: 1}
2026-02-21 17:51:35,171 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29011 PRE-BROADCAST trim=[0, 0] new_y_len=2
2026-02-21 17:51:35,171 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29011 POST-BROADCAST done
2026-02-21 17:51:35,293 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29012, input_shape=(2, 2), n_reqs=2, cache_idx=65, draft_lengths=[1, 1]
2026-02-21 17:51:35,293 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29012 PRE-FORWARD input_shape=(2, 2) cache_idx=65
2026-02-21 17:51:35,392 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29012 POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:35,393 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29012 POST-REJECT n_results=2
2026-02-21 17:51:35,419 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29012 post-trim: trim_amounts=[0, 1], accepted_per_req={f831b4a1-b73a-4dd9-bf81-204170332685: 1, 05914e08-cecb-4263-bcb5-5be7209151ac: 0}
2026-02-21 17:51:35,420 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29012 PRE-BROADCAST trim=[0, 1] new_y_len=2
2026-02-21 17:51:35,420 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29012 POST-BROADCAST done
2026-02-21 17:51:35,543 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29013, input_shape=(2, 2), n_reqs=2, cache_idx=66, draft_lengths=[1, 1]
2026-02-21 17:51:35,543 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29013 PRE-FORWARD input_shape=(2, 2) cache_idx=66
2026-02-21 17:51:35,643 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29013 POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:35,644 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29013 POST-REJECT n_results=2
2026-02-21 17:51:35,670 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29013 post-trim: trim_amounts=[1, 0], accepted_per_req={f831b4a1-b73a-4dd9-bf81-204170332685: 0, 05914e08-cecb-4263-bcb5-5be7209151ac: 1}
2026-02-21 17:51:35,671 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29013 PRE-BROADCAST trim=[1, 0] new_y_len=2
2026-02-21 17:51:35,672 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29013 POST-BROADCAST done
2026-02-21 17:51:35,795 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29014, input_shape=(2, 2), n_reqs=2, cache_idx=68, draft_lengths=[1, 1]
2026-02-21 17:51:35,796 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29014 PRE-FORWARD input_shape=(2, 2) cache_idx=68
2026-02-21 17:51:35,894 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29014 POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:35,895 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29014 POST-REJECT n_results=2
2026-02-21 17:51:35,922 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29014 post-trim: trim_amounts=[0, 1], accepted_per_req={f831b4a1-b73a-4dd9-bf81-204170332685: 1, 05914e08-cecb-4263-bcb5-5be7209151ac: 0}
2026-02-21 17:51:35,922 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29014 PRE-BROADCAST trim=[0, 1] new_y_len=2
2026-02-21 17:51:35,922 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29014 POST-BROADCAST done
2026-02-21 17:51:36,046 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29015, input_shape=(2, 2), n_reqs=2, cache_idx=69, draft_lengths=[1, 1]
2026-02-21 17:51:36,046 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29015 PRE-FORWARD input_shape=(2, 2) cache_idx=69
2026-02-21 17:51:36,146 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29015 POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:36,146 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29015 POST-REJECT n_results=2
2026-02-21 17:51:36,173 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29015 post-trim: trim_amounts=[1, 0], accepted_per_req={f831b4a1-b73a-4dd9-bf81-204170332685: 0, 05914e08-cecb-4263-bcb5-5be7209151ac: 1}
2026-02-21 17:51:36,173 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29015 PRE-BROADCAST trim=[1, 0] new_y_len=2
2026-02-21 17:51:36,174 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29015 POST-BROADCAST done
2026-02-21 17:51:36,298 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29016, input_shape=(2, 2), n_reqs=2, cache_idx=71, draft_lengths=[1, 1]
2026-02-21 17:51:36,298 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29016 PRE-FORWARD input_shape=(2, 2) cache_idx=71
2026-02-21 17:51:36,398 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29016 POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:36,399 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29016 POST-REJECT n_results=2
2026-02-21 17:51:36,425 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29016 post-trim: trim_amounts=[1, 1], accepted_per_req={f831b4a1-b73a-4dd9-bf81-204170332685: 0, 05914e08-cecb-4263-bcb5-5be7209151ac: 0}
2026-02-21 17:51:36,426 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29016 PRE-BROADCAST trim=[1, 1] new_y_len=2
2026-02-21 17:51:36,426 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29016 POST-BROADCAST done
2026-02-21 17:51:36,551 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29017, input_shape=(2, 2), n_reqs=2, cache_idx=72, draft_lengths=[1, 1]
2026-02-21 17:51:36,552 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29017 PRE-FORWARD input_shape=(2, 2) cache_idx=72
2026-02-21 17:51:36,650 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29017 POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:36,651 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29017 POST-REJECT n_results=2
2026-02-21 17:51:36,678 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29017 post-trim: trim_amounts=[0, 1], accepted_per_req={f831b4a1-b73a-4dd9-bf81-204170332685: 1, 05914e08-cecb-4263-bcb5-5be7209151ac: 0}
2026-02-21 17:51:36,678 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29017 PRE-BROADCAST trim=[0, 1] new_y_len=2
2026-02-21 17:51:36,679 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29017 POST-BROADCAST done
2026-02-21 17:51:36,805 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29018, input_shape=(2, 2), n_reqs=2, cache_idx=73, draft_lengths=[1, 1]
2026-02-21 17:51:36,805 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29018 PRE-FORWARD input_shape=(2, 2) cache_idx=73
2026-02-21 17:51:36,906 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29018 POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:36,907 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29018 POST-REJECT n_results=2
2026-02-21 17:51:36,933 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29018 post-trim: trim_amounts=[1, 1], accepted_per_req={f831b4a1-b73a-4dd9-bf81-204170332685: 0, 05914e08-cecb-4263-bcb5-5be7209151ac: 0}
2026-02-21 17:51:36,933 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29018 PRE-BROADCAST trim=[1, 1] new_y_len=2
2026-02-21 17:51:36,934 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29018 POST-BROADCAST done
2026-02-21 17:51:37,060 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29019, input_shape=(2, 2), n_reqs=2, cache_idx=74, draft_lengths=[1, 1]
2026-02-21 17:51:37,060 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29019 PRE-FORWARD input_shape=(2, 2) cache_idx=74
2026-02-21 17:51:37,159 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29019 POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:37,160 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29019 POST-REJECT n_results=2
2026-02-21 17:51:37,186 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29019 post-trim: trim_amounts=[1, 0], accepted_per_req={f831b4a1-b73a-4dd9-bf81-204170332685: 0, 05914e08-cecb-4263-bcb5-5be7209151ac: 1}
2026-02-21 17:51:37,186 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29019 PRE-BROADCAST trim=[1, 0] new_y_len=2
2026-02-21 17:51:37,187 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29019 POST-BROADCAST done
2026-02-21 17:51:37,317 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29020, input_shape=(2, 2), n_reqs=2, cache_idx=76, draft_lengths=[1, 1]
2026-02-21 17:51:37,317 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29020 PRE-FORWARD input_shape=(2, 2) cache_idx=76
2026-02-21 17:51:37,416 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29020 POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:37,417 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29020 POST-REJECT n_results=2
2026-02-21 17:51:37,443 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29020 post-trim: trim_amounts=[1, 0], accepted_per_req={f831b4a1-b73a-4dd9-bf81-204170332685: 0, 05914e08-cecb-4263-bcb5-5be7209151ac: 1}
2026-02-21 17:51:37,444 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29020 PRE-BROADCAST trim=[1, 0] new_y_len=2
2026-02-21 17:51:37,445 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29020 POST-BROADCAST done
2026-02-21 17:51:37,573 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29021, input_shape=(2, 2), n_reqs=2, cache_idx=78, draft_lengths=[1, 1]
2026-02-21 17:51:37,573 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29021 PRE-FORWARD input_shape=(2, 2) cache_idx=78
2026-02-21 17:51:37,674 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29021 POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:37,675 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29021 POST-REJECT n_results=2
2026-02-21 17:51:37,675 [Rank 0] vllm_mlx.scheduler INFO: [SpecDecode] steps=700, alpha=0.554, mean_accepted=0.55/1, per_pos=['0.55']
2026-02-21 17:51:37,701 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29021 post-trim: trim_amounts=[1, 0], accepted_per_req={f831b4a1-b73a-4dd9-bf81-204170332685: 0, 05914e08-cecb-4263-bcb5-5be7209151ac: 1}
2026-02-21 17:51:37,701 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29021 PRE-BROADCAST trim=[1, 0] new_y_len=2
2026-02-21 17:51:37,702 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29021 POST-BROADCAST done
2026-02-21 17:51:37,832 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29022, input_shape=(2, 2), n_reqs=2, cache_idx=80, draft_lengths=[1, 1]
2026-02-21 17:51:37,833 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29022 PRE-FORWARD input_shape=(2, 2) cache_idx=80
2026-02-21 17:51:37,936 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29022 POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:37,937 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29022 POST-REJECT n_results=2
2026-02-21 17:51:37,963 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29022 post-trim: trim_amounts=[1, 0], accepted_per_req={f831b4a1-b73a-4dd9-bf81-204170332685: 0, 05914e08-cecb-4263-bcb5-5be7209151ac: 1}
2026-02-21 17:51:37,964 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29022 PRE-BROADCAST trim=[1, 0] new_y_len=2
2026-02-21 17:51:37,964 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29022 POST-BROADCAST done
2026-02-21 17:51:38,094 [Rank 0] vllm_mlx.scheduler DEBUG: [SpecDecode TP] step=29023, input_shape=(2, 2), n_reqs=2, cache_idx=82, draft_lengths=[1, 1]
2026-02-21 17:51:38,095 [Rank 0] vllm_mlx.scheduler INFO: [SD-TP] step=29023 PRE-FORWARD input_shape=(2, 2) cache_idx=82
```

### hwstudio2

*(showing last 200 of 1574 lines)*

```
2026-02-21 17:51:28,887 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,888 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,888 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,888 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,888 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,888 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,889 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,889 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,889 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,889 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,889 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,890 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,890 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,890 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,890 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,890 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,891 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,891 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,891 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,891 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,892 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,892 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,892 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,892 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,892 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,893 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,893 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,893 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,893 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,893 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,894 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,894 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,894 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,894 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,894 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,895 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,895 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,895 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,895 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,895 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,896 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,896 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,896 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,896 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,896 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,897 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,897 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,897 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,897 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,897 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,897 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,898 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,898 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,898 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,898 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,899 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,899 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,899 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,899 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,899 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:28,900 [Rank 1] vllm_mlx.spec_decode.cache_utils DEBUG: fixup_cache_after_filter: _idx 293 -> 287
2026-02-21 17:51:29,035 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(1, 2) cache_idx=287
2026-02-21 17:51:29,119 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(1, 2, 163840)
2026-02-21 17:51:29,119 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:29,144 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[1]
2026-02-21 17:51:29,259 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(1, 2) cache_idx=288
2026-02-21 17:51:29,341 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(1, 2, 163840)
2026-02-21 17:51:29,341 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:29,368 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[1]
2026-02-21 17:51:29,482 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(1, 2) cache_idx=289
2026-02-21 17:51:29,565 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(1, 2, 163840)
2026-02-21 17:51:29,565 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:29,591 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[1]
2026-02-21 17:51:29,705 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(1, 2) cache_idx=290
2026-02-21 17:51:29,787 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(1, 2, 163840)
2026-02-21 17:51:29,787 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:29,788 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[0]
2026-02-21 17:51:29,903 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(1, 2) cache_idx=292
2026-02-21 17:51:29,985 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(1, 2, 163840)
2026-02-21 17:51:29,985 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:29,986 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[0]
2026-02-21 17:51:31,121 [Rank 1] __main__ INFO: [W-NORMAL] step, batch_size=1
2026-02-21 17:51:31,429 [Rank 1] __main__ DEBUG: [_synced_step] rank=1 step=9 pre=1008 post=1008
2026-02-21 17:51:31,478 [Rank 1] __main__ DEBUG: [_synced_step] rank=1 step=10 pre=2742 post=2742
2026-02-21 17:51:31,528 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(1, 2) cache_idx=37
2026-02-21 17:51:31,604 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(1, 2, 163840)
2026-02-21 17:51:31,604 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:31,630 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[1]
2026-02-21 17:51:31,680 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(1, 2) cache_idx=38
2026-02-21 17:51:31,756 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(1, 2, 163840)
2026-02-21 17:51:31,756 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:31,758 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[0]
2026-02-21 17:51:31,810 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(1, 2) cache_idx=40
2026-02-21 17:51:31,887 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(1, 2, 163840)
2026-02-21 17:51:31,887 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:31,889 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[0]
2026-02-21 17:51:31,946 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(1, 2) cache_idx=42
2026-02-21 17:51:32,022 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(1, 2, 163840)
2026-02-21 17:51:32,022 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:32,024 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[0]
2026-02-21 17:51:32,082 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(1, 2) cache_idx=44
2026-02-21 17:51:32,159 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(1, 2, 163840)
2026-02-21 17:51:32,159 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:32,186 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[1]
2026-02-21 17:51:32,244 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(1, 2) cache_idx=45
2026-02-21 17:51:32,320 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(1, 2, 163840)
2026-02-21 17:51:32,320 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:32,321 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[0]
2026-02-21 17:51:32,379 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(1, 2) cache_idx=47
2026-02-21 17:51:32,456 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(1, 2, 163840)
2026-02-21 17:51:32,456 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:32,483 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[1]
2026-02-21 17:51:32,496 [Rank 1] __main__ INFO: [W-NORMAL] step, batch_size=2
2026-02-21 17:51:32,793 [Rank 1] __main__ DEBUG: [_synced_step] rank=1 step=11 pre=1008 post=1008
2026-02-21 17:51:32,870 [Rank 1] __main__ DEBUG: [_synced_step] rank=1 step=12 pre=[387, 2742] post=[387, 2742]
2026-02-21 17:51:32,977 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(2, 2) cache_idx=49
2026-02-21 17:51:33,070 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:33,070 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:33,099 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[0, 1]
2026-02-21 17:51:33,204 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(2, 2) cache_idx=51
2026-02-21 17:51:33,298 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:33,299 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:33,300 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[0, 0]
2026-02-21 17:51:33,409 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(2, 2) cache_idx=53
2026-02-21 17:51:33,504 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:33,504 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:33,532 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[1, 0]
2026-02-21 17:51:33,647 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(2, 2) cache_idx=54
2026-02-21 17:51:33,742 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:33,742 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:33,744 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[0, 0]
2026-02-21 17:51:33,861 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(2, 2) cache_idx=56
2026-02-21 17:51:33,956 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:33,956 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:33,981 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[1, 1]
2026-02-21 17:51:34,099 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(2, 2) cache_idx=57
2026-02-21 17:51:34,195 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:34,195 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:34,197 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[0, 0]
2026-02-21 17:51:34,315 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(2, 2) cache_idx=59
2026-02-21 17:51:34,410 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:34,410 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:34,438 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[1, 1]
2026-02-21 17:51:34,558 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(2, 2) cache_idx=60
2026-02-21 17:51:34,651 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:34,651 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:34,679 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[1, 0]
2026-02-21 17:51:34,798 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(2, 2) cache_idx=62
2026-02-21 17:51:34,925 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:34,925 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:34,954 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[1, 1]
2026-02-21 17:51:35,072 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(2, 2) cache_idx=63
2026-02-21 17:51:35,171 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:35,171 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:35,173 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[0, 0]
2026-02-21 17:51:35,295 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(2, 2) cache_idx=65
2026-02-21 17:51:35,394 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:35,394 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:35,422 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[0, 1]
2026-02-21 17:51:35,545 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(2, 2) cache_idx=66
2026-02-21 17:51:35,645 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:35,645 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:35,673 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[1, 0]
2026-02-21 17:51:35,797 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(2, 2) cache_idx=68
2026-02-21 17:51:35,896 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:35,896 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:35,924 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[0, 1]
2026-02-21 17:51:36,047 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(2, 2) cache_idx=69
2026-02-21 17:51:36,147 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:36,147 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:36,175 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[1, 0]
2026-02-21 17:51:36,300 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(2, 2) cache_idx=71
2026-02-21 17:51:36,400 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:36,400 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:36,428 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[1, 1]
2026-02-21 17:51:36,553 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(2, 2) cache_idx=72
2026-02-21 17:51:36,652 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:36,652 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:36,681 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[0, 1]
2026-02-21 17:51:36,807 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(2, 2) cache_idx=73
2026-02-21 17:51:36,907 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:36,908 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:36,936 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[1, 1]
2026-02-21 17:51:37,062 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(2, 2) cache_idx=74
2026-02-21 17:51:37,161 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:37,161 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:37,189 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[1, 0]
2026-02-21 17:51:37,319 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(2, 2) cache_idx=76
2026-02-21 17:51:37,418 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:37,418 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:37,446 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[1, 0]
2026-02-21 17:51:37,575 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(2, 2) cache_idx=78
2026-02-21 17:51:37,675 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:37,676 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:37,704 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[1, 0]
2026-02-21 17:51:37,834 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(2, 2) cache_idx=80
2026-02-21 17:51:37,938 [Rank 1] __main__ INFO: [SD-W] POST-FORWARD logits_shape=(2, 2, 163840)
2026-02-21 17:51:37,938 [Rank 1] __main__ INFO: [SD-W] PRE-RECEIVE waiting for SpecDecodeResult
2026-02-21 17:51:37,966 [Rank 1] __main__ INFO: [SD-W] POST-RECEIVE trim=[1, 0]
2026-02-21 17:51:38,096 [Rank 1] __main__ INFO: [SD-W] PRE-FORWARD input_shape=(2, 2) cache_idx=82
```

